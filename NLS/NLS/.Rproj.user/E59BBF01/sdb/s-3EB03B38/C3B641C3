{
    "contents" : "\nR Code to Generate the Simulated Data and Run All Analyses\n# The goal is to show all the R code that you would need\n# to reproduce everything that has been reported.\n# We will use the mvtnorm package in order to randomly \n# generate a data set with a given correlation pattern.\n\n# First, we create a matrix of factor loadings.\n# This pattern is called bifactor because it has a \n# general factor with loadings from all the items\n# and specific factors for separate components.\n# The outcome variables are also formed as \n# combinations of these general and specific factors.\ninstall.packages(\"r-base-dev\")\ninstall.packages(\"qgraph\")\ninstall.packages(\"mvtnorm\") \n\n\nloadings <- matrix(c (\n  .33, .58, .00, .00,  # Ease of Making Reservation \n  .35, .55, .00, .00,  # Availability of Preferred Seats\n  .30, .52, .00, .00,  # Variety of Flight Options\n  .40, .50, .00, .00,  # Ticket Prices\n  .50, .00, .55, .00,  # Seat Comfort\n  .41, .00, .51, .00,  # Roominess of Seat Area\n  .45, .00, .57, .00,  # Availability of Overhead Storage\n  .32, .00, .54, .00,  # Cleanliness of Aircraft\n  .35, .00, .00, .50,  # Courtesy\n  .38, .00, .00, .57,  # Friendliness\n  .60, .00, .00, .50,  # Helpfulness\n  .52, .00, .00, .58,  # Service\n  .43, .10, .20, .30,  # Overall Satisfaction\n  .35, .50, .40, .20,  # Purchase Intention\n  .25, .50, .50, .00), # Willingness to Recommend\n  nrow=15,ncol=4, byrow=TRUE)\n\n# Matrix multiplication produces the correlation matrix, \n# except for the diagonal.\ncor_matrix<-loadings %*% t(loadings)\n# Diagonal set to ones.\ndiag(cor_matrix)<-1 \n\n\nlibrary(qgraph)\n\nlibrary(mvtnorm)\nN=1000\nset.seed(7654321) #needed in order to reproduce the same data each time\nstd_ratings<-as.data.frame(rmvnorm(N, sigma=cor_matrix))\n\n# Creates a mixture of two data sets:\n# first 50 observations assinged uniformly lower scores.\nratings<-data.frame(matrix(rep(0,15000),nrow=1000))\nratings[1:50,]<-std_ratings[1:50,]*2\nratings[51:1000,]<-std_ratings[51:1000,]*2+7.0\n\n# Ratings given different means\nratings[1]<-ratings[1]+2.2\nratings[2]<-ratings[2]+0.6\nratings[3]<-ratings[3]+0.3\nratings[4]<-ratings[4]+0.0\nratings[5]<-ratings[5]+1.5\nratings[6]<-ratings[6]+1.0\nratings[7]<-ratings[7]+0.5\nratings[8]<-ratings[8]+1.5\nratings[9]<-ratings[9]+2.4\nratings[10]<-ratings[10]+2.2\nratings[11]<-ratings[11]+2.1\nratings[12]<-ratings[12]+2.0\nratings[13]<-ratings[13]+1.5\nratings[14]<-ratings[14]+1.0\nratings[15]<-ratings[15]+0.5\n\n# Truncates Scale to be between 1 and 9\nratings[ratings>9]<-9\nratings[ratings<1]<-1\n# Rounds to single digit.\nratings<-round(ratings,0)\n\n# Assigns names to the variables in the data frame called ratings\nnames(ratings)=c(\n  \"Sports\",\n  \"Urban\",\n  \"Adventurous\",\n  \"Diverse\",\n  \"Educated\",\n  \"Affluent\",\n  \"Optimism\",\n  \"Aspiring\",\n  \"Curious\",\n  \"Friendliness\",\n  \"Influencer\",\n  \"Tech Friendly\",\n  \"Wearable\",\n  \"Optimistic\",\n  \"Recommend\")\n\n# Calls qgraph package to run Network Map\n\n\nlibrary(qgraph)\n# creates grouping of variables to be assigned different colors.\n#gr<-list(1:4,5:8,9:12,13:15) \ngr<-list(1:4,5:8,9:11,11:15) \nqgraph(cor(ratings),layout=\"spring\", groups=gr, labels=names(ratings), label.scale=TRUE, minimum=0.50)\n\n# Calculates z-scores so that regression analysis will yield \n# standardized regression weights\nscaled_ratings<-data.frame(scale(ratings))\nols.sat<-lm(Satisfaction~Easy_Reservation + Preferred_Seats + \n              Flight_Options + Ticket_Prices + Seat_Comfort + Seat_Roominess + \n              Overhead_Storage + Clean_Aircraft + Courtesy + Friendliness + \n              Helpfulness + Service, data=scaled_ratings)\nsummary(ols.sat)\n\nols.rec<-lm(Recommend ~ Easy_Reservation + Preferred_Seats + \n              Flight_Options + Ticket_Prices + Seat_Comfort + Seat_Roominess + \n              Overhead_Storage + Clean_Aircraft + Courtesy + Friendliness + \n              Helpfulness + Service, data=scaled_ratings)\nsummary(ols.rec)\n\nols.fly<-lm(Fly_Again ~ Easy_Reservation + Preferred_Seats + \n              Flight_Options + Ticket_Prices + Seat_Comfort + Seat_Roominess + \n              Overhead_Storage + Clean_Aircraft + Courtesy + Friendliness + \n              Helpfulness + Service, data=scaled_ratings)\nsummary(ols.fly)",
    "created" : 1422283404585.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "834215975",
    "id" : "C3B641C3",
    "lastKnownWriteTime" : 1422828864,
    "path" : "C:/R/MN/qgraph.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}