{
    "contents" : "install.packages(\"bigrquery\")\n\ninstall.packages(\"httpuv\")\n\nlibrary(bigrquery)\nlibrary(httpuv)\n\nres <- query_exec(\"SELECT \n                  c_time, \n                  buy_id, \n                  ad_id,\n                  count(*),\n                  sum(this_country),\n                  ROUND(sum(this_country)/count(*) * 100, 2)\n                  FROM \n                  (select \n                  substr(time,0,10) c_time, \n                  buy_id, \n                  ad_id, \n                  country, \n                  case when country = 'United States' then 1 else 0 end as this_country\n                  from \n                  TABLE_DATE_RANGE(dt.click_5295_, TIMESTAMP('2014-11-10'), TIMESTAMP('2014-11-11'))) \n                  group by c_time, buy_id, ad_id\n                  having sum(this_country)/count(*) between 0.5 and 0.85\"\n                  , project=\"371216794594\")\n\n\nres <- query_exec(\"select count(user_id) as users, date\n                  from\n                  (select\n                  user_id, date(time)as date\n                  from\n                  TABLE_DATE_RANGE(dt.impression_5295_, TIMESTAMP('2014-10-10'), TIMESTAMP('2014-11-01')))\n                  group by date\n                  LIMIT 100\"\n                  , project=\"371216794594\")\n\ngetcampnames <- query_exec(\"select buy, , buy_id, advertiser, advertiser_id\n                           FROM \n                           TABLE_DATE_RANGE(dt.impression_5295_, TIMESTAMP('2014-10-01'), TIMESTAMP('2014-12-31'))\n                           WHERE country = 'United States'\n                           group by buy, advertiser\"\n                           \n                           , project=\"371216794594\")\n;\n\ngetadids <- query_exec(\"select  buy,  buy_id, advertiser, advertiser_id, first(time) as date\n                       FROM \n                       TABLE_DATE_RANGE(dt.impression_5295_, TIMESTAMP('2014-10-01'), TIMESTAMP('2014-12-31'))\n                       WHERE  country = 'United States'\n                       group by  buy, buy_id, advertiser, advertiser_id\"\n                       \n                       , project=\"371216794594\")\n\ninstall.packages(\"sqldf\")\nlibrary(sqldf)\n\n#get data subsets\nAllcamps <- sqldf(\"select * from getadids where advertiser like '%NA %'\")\n\n#get catagories\nAndroid <- sqldf(\"select * from Allcamps where advertiser like 'Android 2%'\")\nChrome <- sqldf(\"select * from Allcamps where buy like 'Chrome %'\")\nBaldwin <- sqldf(\"select * from Allcamps where buy like 'Baldwin %'\")\nChromebook <- sqldf(\"select * from Allcamps where buy like 'Chromebook%'\")\nYIS <- sqldf(\"select * from Allcamps where buy like '%Year%'\")\nGSA <- sqldf(\"select * from Allcamps where buy like '%GSA%'\")\nPlay <-  sqldf(\"select * from Allcamps where advertiser like 'Android Market%'\")\nCloud <- sqldf(\"select * from Allcamps where advertiser like '%Cloud%'\")\nYouTube <- sqldf(\"select * from Allcamps where advertiser like '%YouTube%'\")\n\n#trybig query\n\n\n\ngetadids <- query_exec(\"\n                       SELECT  \"Android\" as orgCampaign, \n                       COUNT(DISTINCT CASE WHEN advertiser like 'Android 2%' then user_id else 0 end) as Android,\n                       COUNT(DISTINCT CASE WHEN buy like 'Chrome %' then user_id else 0 end) as Chrome,\n                       COUNT(DISTINCT CASE WHEN buy like 'Baldwin %' then user_id else 0 end) as Baldwin\n                       FROM \n                       TABLE_DATE_RANGE(dt.impression_5295_, TIMESTAMP('2014-10-01'), TIMESTAMP('2014-10-02'))\n                       WHERE  country = 'United States'\n                       AND advertiser like 'Android 2%' \n                       \n                       , project=\"371216794594\")\n                       \n                       \n                       \n                       \n\ngetandroidrow <- query_exec(\"\n                       SELECT  'Android' as orgCampaign, \n                       COUNT(DISTINCT CASE WHEN advertiser CONTAINS 'Android 2' then id2 else 'a' end) as Android,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'Chrome' then id2 else 'a' end) as Chrome,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'Baldwin' then id2 else 'a' end) as Baldwin,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'Chromebook' then id2 else 'a' end) as Chromebook,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'Year' then id2 else 'a' end) as YIS,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'GSA' then id2 else 'a' end) as GSA,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'Android Market' then id2 else 'a' end) as Play,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'Cloud' then id2 else 'a' end) as Cloud,\n                       COUNT(DISTINCT CASE WHEN buy CONTAINS 'YouTube' then id2 else 'a' end) as YouTube,\n                       From (\n                         \n                         select  id2 , buy, advertiser\n                         From \n                         (\n                           select \n                           user_id as id2, buy, advertiser\n                           FROM\n                           TABLE_DATE_RANGE(dt.impression_5295_, TIMESTAMP('2014-12-01'), TIMESTAMP('2014-12-02'))\n                           WHERE  country = 'United States'\n                           group each by  id2 ,buy, advertiser\n                         ) as tb1  \n                         \n                         INNER JOIN EACH\n                         (\n                           select  user_id\n                           From \n                           (\n                             select \n                             user_id\n                             FROM\n                             TABLE_DATE_RANGE(dt.impression_5295_, TIMESTAMP('2014-12-01'), TIMESTAMP('2014-12-02'))\n                             WHERE  country = 'United States'\n                             AND advertiser CONTAINS 'Android 2' \n                             group each by  user_id \n                           )) as tb2 ON tb1.id2 = tb2.user_id )\n                       \n                       \" \n                       , project=\"371216794594\")\n                       \n                       \n                       \n                       \n                       ",
    "created" : 1422903114097.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "2430836982",
    "id" : "41EBF3BF",
    "lastKnownWriteTime" : 12948304202498162,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled4"
    },
    "source_on_save" : false,
    "type" : "r_source"
}